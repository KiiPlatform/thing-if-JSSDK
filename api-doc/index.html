<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Action.html">Action</a></li><li><a href="ActionResult.html">ActionResult</a></li><li><a href="AggregatedResults.html">AggregatedResults</a></li><li><a href="AggregateGroupedHistoryStatesRequest.html">AggregateGroupedHistoryStatesRequest</a></li><li><a href="Aggregation.html">Aggregation</a></li><li><a href="AliasAction.html">AliasAction</a><ul class='methods'><li data-type='method'><a href="AliasAction.html#getAction">getAction</a></li></ul></li><li><a href="AliasActionResult.html">AliasActionResult</a><ul class='methods'><li data-type='method'><a href="AliasActionResult.html#getActionResults">getActionResults</a></li></ul></li><li><a href="AllClause.html">AllClause</a><ul class='methods'><li data-type='method'><a href="AllClause.html#toJson">toJson</a></li></ul></li><li><a href="AndClauseInQuery.html">AndClauseInQuery</a></li><li><a href="AndClauseInTrigger.html">AndClauseInTrigger</a></li><li><a href="APIAuthor.html">APIAuthor</a><ul class='methods'><li data-type='method'><a href="APIAuthor.html#aggregate">aggregate</a></li><li data-type='method'><a href="APIAuthor.html#deleteTrigger">deleteTrigger</a></li><li data-type='method'><a href="APIAuthor.html#enableTrigger">enableTrigger</a></li><li data-type='method'><a href="APIAuthor.html#getCommand">getCommand</a></li><li data-type='method'><a href="APIAuthor.html#getFirmwareVersion">getFirmwareVersion</a></li><li data-type='method'><a href="APIAuthor.html#getState">getState</a></li><li data-type='method'><a href="APIAuthor.html#getThingType">getThingType</a></li><li data-type='method'><a href="APIAuthor.html#getTrigger">getTrigger</a></li><li data-type='method'><a href="APIAuthor.html#getVendorThingID">getVendorThingID</a></li><li data-type='method'><a href="APIAuthor.html#groupedQuery">groupedQuery</a></li><li data-type='method'><a href="APIAuthor.html#installFCM">installFCM</a></li><li data-type='method'><a href="APIAuthor.html#listCommands">listCommands</a></li><li data-type='method'><a href="APIAuthor.html#listServerCodeExecutionResults">listServerCodeExecutionResults</a></li><li data-type='method'><a href="APIAuthor.html#listTriggers">listTriggers</a></li><li data-type='method'><a href="APIAuthor.html#onboardWithThingID">onboardWithThingID</a></li><li data-type='method'><a href="APIAuthor.html#onboardWithVendorThingID">onboardWithVendorThingID</a></li><li data-type='method'><a href="APIAuthor.html#patchCommandTrigger">patchCommandTrigger</a></li><li data-type='method'><a href="APIAuthor.html#patchServerCodeTrigger">patchServerCodeTrigger</a></li><li data-type='method'><a href="APIAuthor.html#postCommandTrigger">postCommandTrigger</a></li><li data-type='method'><a href="APIAuthor.html#postNewCommand">postNewCommand</a></li><li data-type='method'><a href="APIAuthor.html#postServerCodeTrigger">postServerCodeTrigger</a></li><li data-type='method'><a href="APIAuthor.html#query">query</a></li><li data-type='method'><a href="APIAuthor.html#uninstallPush">uninstallPush</a></li><li data-type='method'><a href="APIAuthor.html#updateFirmwareVersion">updateFirmwareVersion</a></li><li data-type='method'><a href="APIAuthor.html#updateThingType">updateThingType</a></li><li data-type='method'><a href="APIAuthor.html#updateVendorThingID">updateVendorThingID</a></li></ul></li><li><a href="App.html">App</a><ul class='methods'><li data-type='method'><a href="App.html#getKiiCloudBaseUrl">getKiiCloudBaseUrl</a></li><li data-type='method'><a href="App.html#getThingIFBaseUrl">getThingIFBaseUrl</a></li></ul></li><li><a href="AppBuilder.html">AppBuilder</a><ul class='methods'><li data-type='method'><a href="AppBuilder.html#.buildWithHostname">buildWithHostname</a></li><li data-type='method'><a href="AppBuilder.html#.buildWithSite">buildWithSite</a></li></ul></li><li><a href="Command.html">Command</a><ul class='methods'><li data-type='method'><a href="Command.html#getAliasActionResults">getAliasActionResults</a></li><li data-type='method'><a href="Command.html#getAliasActions">getAliasActions</a></li></ul></li><li><a href="Condition.html">Condition</a></li><li><a href="EqualsClauseInQuery.html">EqualsClauseInQuery</a></li><li><a href="EqualsClauseInTrigger.html">EqualsClauseInTrigger</a></li><li><a href="ErrorResponseBody.html">ErrorResponseBody</a></li><li><a href="GroupedHistoryStates.html">GroupedHistoryStates</a></li><li><a href="HistoryState.html">HistoryState</a></li><li><a href="HttpRequestError.html">HttpRequestError</a></li><li><a href="ListQueryOptions.html">ListQueryOptions</a><ul class='methods'><li data-type='method'><a href="ListQueryOptions.html#.getQueryString">getQueryString</a></li></ul></li><li><a href="Logger.html">Logger</a><ul class='methods'><li data-type='method'><a href="Logger.html#.getInstance">getInstance</a></li><li data-type='method'><a href="Logger.html#getLogLevel">getLogLevel</a></li><li data-type='method'><a href="Logger.html#log">log</a></li><li data-type='method'><a href="Logger.html#logHttpRequest">logHttpRequest</a></li><li data-type='method'><a href="Logger.html#setLogLevel">setLogLevel</a></li></ul></li><li><a href="MqttEndpoint.html">MqttEndpoint</a></li><li><a href="NotEqualsClauseInQuery.html">NotEqualsClauseInQuery</a></li><li><a href="NotEqualsClauseInTrigger.html">NotEqualsClauseInTrigger</a></li><li><a href="OnboardingResult.html">OnboardingResult</a></li><li><a href="OnboardWithThingIDRequest.html">OnboardWithThingIDRequest</a></li><li><a href="OnboardWithVendorThingIDRequest.html">OnboardWithVendorThingIDRequest</a></li><li><a href="OrClauseInQuery.html">OrClauseInQuery</a></li><li><a href="OrClauseInTrigger.html">OrClauseInTrigger</a></li><li><a href="PatchCommandTriggerRequest.html">PatchCommandTriggerRequest</a></li><li><a href="PatchServerCodeTriggerRequest.html">PatchServerCodeTriggerRequest</a></li><li><a href="PostCommandRequest.html">PostCommandRequest</a></li><li><a href="PostCommandTriggerRequest.html">PostCommandTriggerRequest</a></li><li><a href="PostServerCodeTriggerRequest.html">PostServerCodeTriggerRequest</a></li><li><a href="Predicate.html">Predicate</a></li><li><a href="QueryClause.html">QueryClause</a></li><li><a href="QueryGroupedHistoryStatesRequest.html">QueryGroupedHistoryStatesRequest</a></li><li><a href="QueryHistoryStatesRequest.html">QueryHistoryStatesRequest</a></li><li><a href="QueryResult.html">QueryResult</a></li><li><a href="RangeClauseInQuery.html">RangeClauseInQuery</a><ul class='methods'><li data-type='method'><a href="RangeClauseInQuery.html#.greaterThan">greaterThan</a></li><li data-type='method'><a href="RangeClauseInQuery.html#.greaterThanEquals">greaterThanEquals</a></li><li data-type='method'><a href="RangeClauseInQuery.html#.lessThan">lessThan</a></li><li data-type='method'><a href="RangeClauseInQuery.html#.lessThanEquals">lessThanEquals</a></li></ul></li><li><a href="RangeClauseInTrigger.html">RangeClauseInTrigger</a><ul class='methods'><li data-type='method'><a href="RangeClauseInTrigger.html#.greaterThan">greaterThan</a></li><li data-type='method'><a href="RangeClauseInTrigger.html#.greaterThanEquals">greaterThanEquals</a></li><li data-type='method'><a href="RangeClauseInTrigger.html#.lessThan">lessThan</a></li><li data-type='method'><a href="RangeClauseInTrigger.html#.lessThanEquals">lessThanEquals</a></li></ul></li><li><a href="ScheduleOncePredicate.html">ScheduleOncePredicate</a><ul class='methods'><li data-type='method'><a href="ScheduleOncePredicate.html#getEventSource">getEventSource</a></li></ul></li><li><a href="SchedulePredicate.html">SchedulePredicate</a><ul class='methods'><li data-type='method'><a href="SchedulePredicate.html#getEventSource">getEventSource</a></li></ul></li><li><a href="ServerCode.html">ServerCode</a></li><li><a href="ServerCodeResult.html">ServerCodeResult</a><ul class='methods'><li data-type='method'><a href="ServerCodeResult.html#.fromJson">fromJson</a></li></ul></li><li><a href="ServerError.html">ServerError</a><ul class='methods'><li data-type='method'><a href="ServerError.html#.fromJson">fromJson</a></li></ul></li><li><a href="StatePredicate.html">StatePredicate</a><ul class='methods'><li data-type='method'><a href="StatePredicate.html#getEventSource">getEventSource</a></li></ul></li><li><a href="ThingIFAPI.html">ThingIFAPI</a><ul class='methods'><li data-type='method'><a href="ThingIFAPI.html#aggregate">aggregate</a></li><li data-type='method'><a href="ThingIFAPI.html#deleteTrigger">deleteTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#enableTrigger">enableTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#getCommand">getCommand</a></li><li data-type='method'><a href="ThingIFAPI.html#getFirmwareVersion">getFirmwareVersion</a></li><li data-type='method'><a href="ThingIFAPI.html#getState">getState</a></li><li data-type='method'><a href="ThingIFAPI.html#getThingType">getThingType</a></li><li data-type='method'><a href="ThingIFAPI.html#getTrigger">getTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#getVendorThingID">getVendorThingID</a></li><li data-type='method'><a href="ThingIFAPI.html#groupedQuery">groupedQuery</a></li><li data-type='method'><a href="ThingIFAPI.html#installFCM">installFCM</a></li><li data-type='method'><a href="ThingIFAPI.html#listCommands">listCommands</a></li><li data-type='method'><a href="ThingIFAPI.html#listServerCodeExecutionResults">listServerCodeExecutionResults</a></li><li data-type='method'><a href="ThingIFAPI.html#listTriggers">listTriggers</a></li><li data-type='method'><a href="ThingIFAPI.html#onboardWithThingID">onboardWithThingID</a></li><li data-type='method'><a href="ThingIFAPI.html#onboardWithVendorThingID">onboardWithVendorThingID</a></li><li data-type='method'><a href="ThingIFAPI.html#patchCommandTrigger">patchCommandTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#patchServerCodeTrigger">patchServerCodeTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#postCommandTrigger">postCommandTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#postNewCommand">postNewCommand</a></li><li data-type='method'><a href="ThingIFAPI.html#postServerCodeTrigger">postServerCodeTrigger</a></li><li data-type='method'><a href="ThingIFAPI.html#query">query</a></li><li data-type='method'><a href="ThingIFAPI.html#uninstallPush">uninstallPush</a></li><li data-type='method'><a href="ThingIFAPI.html#updateFirmwareVersion">updateFirmwareVersion</a></li><li data-type='method'><a href="ThingIFAPI.html#updateThingType">updateThingType</a></li><li data-type='method'><a href="ThingIFAPI.html#updateVendorThingID">updateVendorThingID</a></li></ul></li><li><a href="ThingIFError.html">ThingIFError</a></li><li><a href="TimeRange.html">TimeRange</a></li><li><a href="Trigger.html">Trigger</a></li><li><a href="TriggerClause.html">TriggerClause</a></li><li><a href="TriggerCommandObject.html">TriggerCommandObject</a></li><li><a href="TypedID.html">TypedID</a><ul class='methods'><li data-type='method'><a href="TypedID.html#toString">toString</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#CommandState">CommandState</a></li><li><a href="global.html#default_1">default_1</a></li><li><a href="global.html#Errors">Errors</a></li><li><a href="global.html#EventSource">EventSource</a></li><li><a href="global.html#FieldType">FieldType</a></li><li><a href="global.html#FunctionType">FunctionType</a></li><li><a href="global.html#LayoutPosition">LayoutPosition</a></li><li><a href="global.html#LogLevel">LogLevel</a></li><li><a href="global.html#Site">Site</a></li><li><a href="global.html#TriggersWhat">TriggersWhat</a></li><li><a href="global.html#TriggersWhen">TriggersWhen</a></li><li><a href="global.html#Types">Types</a></li></ul>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><p><a href="https://badge.fury.io/js/thing-if"><img src="https://badge.fury.io/js/thing-if.svg" alt="npm version"></a>
<a href="https://circleci.com/gh/KiiPlatform/thing-if-JSSDK/tree/master"><img src="https://circleci.com/gh/KiiPlatform/thing-if-JSSDK/tree/master.svg?style=svg" alt="CircleCI"></a>
<a href="https://coveralls.io/github/KiiPlatform/thing-if-JSSDK?branch=master"><img src="https://coveralls.io/repos/github/KiiPlatform/thing-if-JSSDK/badge.svg?branch=master" alt="Coverage Status"></a></p>
<p>Javascript SDK for Kii Thing Interaction Framework.</p>
<h2>Dependecies</h2><ul>
<li><a href="https://github.com/blakeembrey/make-error-cause">make-error-cause</a>.</li>
<li><a href="https://github.com/stefanpenner/es6-promise">es6-promise</a>.</li>
<li><a href="https://github.com/blakeembrey/popsicle">popsicle</a>.</li>
</ul>
<h2>Build SDK</h2><h3>Install NPM packages</h3><pre class="prettyprint source"><code>$ npm install</code></pre><h3>Install typings</h3><pre class="prettyprint source"><code>$ npm install typings -g
$ typings install</code></pre><h3>Build SDK</h3><p>thing-if SDK is built as UMD(Universal Module Definition) library.
So your code can load it either with CommonJS style, AMD style or script tag.</p>
<h4>Normal build</h4><p>Built with <code>gulp</code> command</p>
<pre class="prettyprint source"><code>$ npm run build-src</code></pre><p>If succeeded, library file named <code>thing-if.js</code> is available under <code>./dist/</code> folder.</p>
<h2>Use thing-if in browser app</h2><p><strong>Note</strong>: thing-if SDK uses global Promise, so if the browser doesn't support Promise( like Mircrosoft IE11), it needs to polyfill promise to the browser app.</p>
<p>Basic operations of thing-if SDK are tested and passed on the following browsers: Mozilla Firefox 49.0.1, Safari 9.1.3, Chrome 53.0, and Microsoft Edge 38.</p>
<ol>
<li><p>Clone this repository</p>
<pre class="prettyprint source"><code>$ git clone https://github.com/KiiPlatform/thing-if-JSSDK.git</code></pre></li>
<li><p>Bundle library using browserify.</p>
<p>browserify bundles all the dependencies into a single file.</p>
<pre class="prettyprint source"><code>$ cd thing-if-JSSDK
$ npm install
$ npm install browserify -g
$ browserify . -s ThingIF > thing-if.js</code></pre></li>
<li><p>Include the bundle file in your browser app</p>
<pre class="prettyprint source"><code>&lt;!-- if the browser does not support promise, need to download polyfill promise library(i.e. https://raw.githubusercontent.com/taylorhakes/promise-polyfill/master/promise.js) and import like the following script -->
&lt;script src=&quot;path/to/promise.js&quot;>&lt;/script>

&lt;script src=&quot;path/to/thing-if.js&quot;>&lt;/script></code></pre></li>
</ol>
<h2>Test</h2><h3>Configure TestApp</h3><p>You need to configure <code>TestApp</code> as env variable for testing, the format is <code>[app-id]:[app-key]:[JP|CN3|US|EU|SG]:[client-id]:[client-secret]</code></p>
<pre class="prettyprint source"><code>$ export TestApp=[app-id]:[app-key]:[JP|CN3|US|EU|SG]:[client-id]:[client-secret]</code></pre><h3>Run npm test</h3><pre class="prettyprint source"><code>$ npm test</code></pre><h2>Use cases in nodejs</h2><h3>Integrate with kii-cloud-sdk</h3><p>You usally need to get user id and token from kii-cloud-sdk, you can simply integrate it with thing-if SDK.</p>
<pre class="prettyprint source lang-shell"><code>mkdir MyApp
cd MyApp
npm install kii-cloud-sdk</code></pre><p>Copy thing-if.js in MyApp direcotry and create
file named Onboarding.js in MyApp directory.</p>
<pre class="prettyprint source lang-js"><code>&quot;use strict&quot;
var kiicloud = require(&quot;kii-cloud-sdk&quot;).create();

var thingIF = require('./thing-if.js');

var appid = &quot;****&quot;,
    appkey = &quot;****&quot;,
    site = kiicloud.KiiSite.JP;

kiicloud.Kii.initializeWithSite(appid, appkey, site);

// an already registered kii user
var username = &quot;user-name&quot;;
var pass = &quot;pass&quot;;

kiicloud.KiiUser.authenticate(username, pass).then(function (authedUser) {
    var token = authedUser.getAccessToken();
    var ownerId = authedUser.getID();

    var apiAuthor = new thingIF.APIAuthor(
        token,
        new thingIF.App(
            kiicloud.Kii.getAppID(),
            kiicloud.Kii.getAppKey(),
            &quot;https://api-jp.kii.com&quot;)
    );

    let onboardRequest = new thingIF.OnboardWithVendorThingIDRequest(&quot;vendorthing-id&quot;, &quot;password&quot;, &quot;USER:&quot; + ownerId);
    return apiAuthor.onboardWithVendorThingID(onboardRequest);
}).then(function (res) {
    console.log(&quot;onboarded:&quot;+JSON.stringify(res));
}).catch(function (err) {
    console.log(err);
});</code></pre><p>Execute with node.</p>
<pre class="prettyprint source lang-shell"><code>node Onboarding.js</code></pre><h3>onboard and send command to a thing</h3><p>Create file named Command.js in YourApp directory.</p>
<pre class="prettyprint source lang-js"><code>var thingIF = require('./thing-if.js');

// &lt;Replace those values>
var appID = &quot;appID&quot;;
var appKey = &quot;appKey&quot;;
var appSite = thingIF.Site.JP;

var ownerToken = &quot;owner-token&quot;;
var ownerID = &quot;owner-id&quot;;
var vendorThingID = &quot;th.myTest&quot;;
var thingPassword = &quot;password&quot;;
// &lt;Replace those values/>

var app = new thingIF.App(appID, appKey, appSite);
var apiAuthor = new thingIF.APIAuthor(ownerToken ,app);
var onboardOptions = new thingIF.OnboardWithVendorThingIDRequest(vendorThingID, thingPassword, ownerID);

// using promise
apiAuthor.onboardWithVendorThingID(onboardOptions).then(function(res){
    var thingID = res.thingID;
    var commandOptions = new thingIF.PostCommandRequest(
        &quot;led-schema&quot;,
        1,
        {turnPower:{power: true}},
        &quot;issuer-id&quot;, // user id of issuer for this command
        &quot;command-target-id&quot; // thingID of thing to send this command
    );
    return apiAuthor.postNewCommand(thingID, commandOptions);
}).then(function(command){
    console.log(&quot;command created:&quot;+command.commandID);
}).catch(function(err){
    console.log(err);
});

// using callbacks
apiAuthor.onboardWithVendorThingID(onboardOptions,
    function(err, res){
        if (err == null || err == undefined) {
            cosnole.log(&quot;onboard failed:&quot; + err);
            // handling err
            return;
        }
        var thingID = res.thingID;
        var commandOptions = new thingIF.PostCommandRequest(
            &quot;led-schema&quot;,
            1,
            {turnPower:{power: true}},
            &quot;issuer-id&quot;, // user id of issuer for this command
            &quot;command-target-id&quot; // thingID of thing to send this command
        );
        apiAuthor.postNewCommand(thingID, commandOptions,
            function(err, command){
                if (err == null || err == undefined) {
                    cosnole.log(&quot;post command failed:&quot; + err);
                    // handling err
                    return;
                }
                console.log(&quot;command created:&quot;+command.commandID);
            }
        );
    }
);</code></pre><p>Execute with node.</p>
<pre class="prettyprint source lang-shell"><code>node Command.js</code></pre><h2>Use in Typescript Project</h2><ul>
<li>install thing-if SDK with npm</li>
</ul>
<pre class="prettyprint source"><code>npm install thing-if --save</code></pre><ul>
<li>install typings</li>
</ul>
<pre class="prettyprint source"><code>typings install npm:thing-if --save</code></pre><ul>
<li>add reference to your code</li>
</ul>
<pre class="prettyprint source"><code>/// &lt;reference path=&quot;./typings/modules/thing-if/index.d.ts&quot; />
import * as ThingIFSDK from 'thing-if'</code></pre><h2>License</h2><p>thing-if-JSSDK is released under the Apache 2.0 license. See LICENSE for details.</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu May 18 2017 08:47:27 GMT+0000 (UTC) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>